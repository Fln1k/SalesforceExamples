<aura:component
  controller="PricebookController"
  extends="c:customFlowVariables"
>
  <!-- Attributes -->
  <aura:attribute name="productsOptions" type="List" default="[]" />
  <aura:attribute name="total" type="Double" default="0.0" />
  <aura:attribute name="subtotals" type="Object" default="{}" />
  <aura:attribute name="selectedPromotion" type="Object" default="{}" />
  <!-- Events -->
  <aura:handler name="init" value="{!this}" action="{!c.init}" />
  <aura:handler
    event="c:showEmptyProductListErrorMessage"
    action="{!c.handleShowEmptyError}"
  />
  <aura:handler
    name="change"
    value="{!v.subtotals}"
    action="{!c.recalculateTotal}"
  />
  <!-- Layout -->
  <c:promotions
    productsOptions="{!v.productsOptions}"
    paymentPlan="{!v.paymentPlan}"
    selectedPromotion="{!v.selectedPromotion}"
    accountId="{!v.accountId}"
  />
  <br />
  <div class="slds-align_absolute-center" style="font-size: x-large">
    Products
  </div>
  <aura:iteration items="{!v.productsOptions}" var="pricebook">
    <c:priceBookTable
      options="{!pricebook}"
      subtotals="{!v.subtotals}"
      promotion="{!v.selectedPromotion}"
    />
    <br />
  </aura:iteration>
  <div style="float: right; font-size: initial; font-family: fantasy">
    Total: {!(v.total ? v.total:0) + v.productsOptions[0].currency}
  </div>
  <br />
</aura:component>
